"""
Утилиты для нормализации адресов
"""
import re


def normalize_address(address: str) -> str:
    """
    Нормализует адрес для группировки объявлений.
    
    Убирает префиксы типа "г.", "ул.", "пр-т", приводит к нижнему регистру,
    убирает лишние пробелы.
    
    Args:
        address: Исходный адрес
        
    Returns:
        Нормализованный адрес
    """
    if not address:
        return ""

    a = address.lower().strip()

    # убрать "г.", "ул.", "пр-т", лишние пробелы
    a = re.sub(r"\b(г\.?|город)\b", "", a)
    a = re.sub(r"\b(ул\.?|улица)\b", "", a)
    a = re.sub(r"\b(пр-т|проспект)\b", "проспект", a)
    a = re.sub(r"\s+", " ", a)

    return a.strip()
